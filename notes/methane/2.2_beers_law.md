---
title: Beer-Lambert's Law
subject: Methane
short_title: Beer's Law
authors:
  - name: J. Emmanuel Johnson
    affiliations:
      - UN
    orcid: 0000-0002-6739-0053
    email: juan.johnson@un.org
license: CC-BY-4.0
keywords: methane
abbreviations:
  PSF: Point Spread Function
  SRF: Spectral Response Function
  GSD: Ground Sample Distance
  AMF: Air Mass Factor
  ODE: Ordinary Differential Equation
  RTE: Radiative Transfer Equation
---

In this document, we will go through the derivation of the famous Beer-Lambert's Law and how it is used for methane retrieval in remote sensing.


## Radiance

> Imagine you're in space looking down at Earth through a very long, very skinny straw. This is your satellite sensor.
> The sun shines on the Earth, and everything on the surface (like trees, water, or sand) bounces that sunlight back up, like tiny flashlights point in different directions.
> **Radiances** is simply how bright one of those tiny flashlights (e.g., a single patch of grass) looks at you when you're looking *directly* at it through your specific tube.
> It's the tiny amount of light energy coming from that one small spot on the ground, traveling in one specific direction, straight up through your sensor, that your sensor actually captures.
> A bright, snowy spot will send a lot of light up your tube (high radiance), whereas a dark forest will send very little (low radiance).

The radiance is a fundamental radiometric quantity that describes the flux of radiant energy through a specific area from a specific direction.
It quantifies the energy per unit time (power) leaving, passing through, or arriving at a surface from a given solid angle, per unit of projected source area, per unit wavelength.


```{math}
:label: radiance
\begin{aligned}
L &= L(\lambda, \mathbf{s}, \boldsymbol{\omega}, t) 
&& && 
[\text{W}\cdot\text{m}^{-2}\text{sr}^{-1}\cdot\text{nm}^{-1}\cdot\text{s}^{-1}]
&& && 
L \in \mathbb{R} 
\end{aligned}
```

The independent variables are as follows:
* $\mathbf{s}\in\mathcal{S}$ - The position in space where the radiance is measured. This is a position vector, and it's units are meters, `[m]`.
* $\boldsymbol{\omega}\in\Omega$ - The direction vector from which the radiance is arriving or towards which is travelling. Radiance is measured per unit solid angle, so this componenet corresponds to the steradian `[sr]`.
* $\lambda\in\Lambda$ - The specific wavelength (i.e., "colour") of the electromagnetic radiation being measured. The units are typically nanomeaters `[nm]` in remote sensing.
* $t\in\mathcal{T}$ - the time at which the observation is made. The units are `[secs]`. In many remote sensing applications, the scene is assumed to be static during the measurement, so this variable is often omitted.

---

## Radiative Transfer Equations

> Imagine you are, again, looking at that patch of grass through your straw.
> The light from the grass travels up the tube to your eye.
> Now, let's say a thin layer of smoke drifts between you and the grass.
> The light you see will get a bit dimmer, right?
> The smoke blocks (a.k.a. absorbs or scatters) some of the light. 
> 
> The Radiative Transfer Equation (RTE) is simply the rule that describes the change in brightness (radiance).
> It says that for every cm that the light travels through the smoke, its brightness will decrease by a certain amount.
> It's a ordinary differential equation (ODE) because it is not about the final brightness, but about the *rate of change* in brightness as the light moves along its path.
> If we also imagine the smoke is hot and glowing slightly, it might *add* a little bit of its own light into your straw.
The **full** RTE is the master rule that accounts for both the light that is lost along the path and the new light that is added.

By its definition, radiance is a quantity that changes as it propagates through a medium.
The equation that governs this change is the RTE.
At its heart, the RTE is a differential equation that accounts for the loss and gain of energy as radiation travels along a path.

Let's start with the simplified case that only considers the loss of radiance, often described by the Beer-Lambert Law.
This equation states that the change in radiance, $L$, as it travels a small distance, $ds$, is proportional to the radiance itself and the extinction coefficient, $\kappa$, of the medium.

```{math}
:label: rte-transmission
\frac{dL(\lambda, s)}{ds} = - \kappa(\lambda,s)\cdot L(\lambda,s)
```
Here:
* $L$ is the radiance at a specific wavelength, $\lambda$, at position, $\mathbf{s}$, along its path. `[W⋅m⁻²⋅sr⁻¹⋅nm⁻¹⋅s⁻¹]`
* $\mathbf{s}$ is the distance along the path of propagation, `[m]`.
* $\kappa(\lambda,\mathbf{s})$ is the **extinction coefficient** of the medium, which describes how effectively the medium absorts and scatters radiation out of the path at that point, `[m⁻¹]`


---
### Scattering

However, this equation only tells half the story-the attenuation of the signal.
In a medium like the atmosphere, energy is also added into the path, for instance, by scattering from other directions or by thermal emission.
This is accounted for in the source term, $J$.
The full RTE is therefore

```{math}
:label: rte-full
\frac{dL(\lambda,s,\omega)}{ds} = - \kappa(\lambda,s)\cdot L(\lambda,s,\omega) + J(\lambda,\mathbf{s},\omega)
```

where $J$ `[W⋅m⁻²⋅sr⁻¹⋅nm⁻¹⋅s⁻¹]` is the **source term** which quantifies the radiation added into the direction $\omega$ at position $\mathbf{s}$.
This term accounts for the phenomena like atmospheric path radiance.

For specific applications like retrieving methane concentrations from satellite imagery, we can often simplify the full Radiative Transfer Equation by ignoring the source term, $J$.
This simplification is valid under a set of reasonable assumptions:

**Wavelength of Observation**.
Methane retrievals are typically performed in the near or short-wave infrared (SWIR) portion of the spectrum.
In this region, the radiance measured by the satellite is overwhelmingly dominated by sunlight that has reflected off the Earth's surface and traveled back up to the sensor.
The thermal energy emitted by the atmosphere itself is negligible at these wavelengths.
This allows us to ignore the emission component of the source term.

**Clear-Sky Conditions**.
The analysis assumes clear-sky conditions, free of significant clouds or aerosols.
While atmospheric scattering (from molecules and aerosols) does contribute to the source term by scattering light into the sensor's line of sight, its effect is much weaker in the SWIR than in visible wavelengths.
This atmospheric path radiance is often treated as a slowly varying background signal that can be modeled and removed, rather than being a dominant part of the radiance change described by the RTE.

**Focus on Absorption**.
The primary goal is to measure the absorption by methane.
This is a high-frequency spectral signature captured by the extinction coefficient, $\kappa$.
The source term, $J$, adds a relatively smooth, low-frequency baseline of radiance.
Because the retrieval algorithms are designed to isolate the sharp, characteristic absorption lines of methane, the extinction term ($-\kappa \cdot L$) becomes the most critical part of the equation.

Given these justifications, the RTE can be reduced to its Beer-Lambert form, $\frac{dL}{ds} = - \kappa \cdot L$, allowing us to directly relate the measured attenuation of radiance to the concentration of methane along the light path.





---
### Solution to ODE

The simplified RTE equation [](#rte-transmission-only) is a first-order ODE.
That means we can calculate the analytical solution

```{math}
:label: rte-simple-soln
L(\lambda) = L_0(\lambda) \cdot \exp\left[-\int_{\mathcal{S}}\kappa(\lambda,\mathbf{s})\cdot d\mathbf{s}\right]
```

We will come back to the equation later.
Firsly, I'd like to introduce a concept within the next section and then we will slowly build the intuition behind this equation.


---
## Beer-Lambert Law

> Think about shining a flashlight through a glass of colored water.
> The light that comes out the other side is dimmer than the light that went in.
> The Beer-Lambert Law is the simple rule that tells you how much dimmer it will be.
> It states that the final brightness depends on three things: 1) the inital brightness of your flashlight, 2) the final brightness of the water, and 3) the transparency of the water.
> More dye or a wider glass means dimmer light on the other side.
> This is an exponential relationship: each layer of water reduces the light by a fraction of its current brightness.


It's analytical solution is the Beer-Lambert Law, which describes the exponential decay of radiance as it passes through a medium.

```{math}
:label: beer-lambert-law-simple
L(\lambda) = L_0(\lambda) \cdot T(\lambda)
```

The terms of the equations are as follows:
* $L(\lambda)$ is the final radiance at wavelength $\lambda$ measured by the sensor after it has passed through the absorbing medium, e.g., the atmosphere. The units are `[W·m⁻²·sr⁻¹·nm⁻¹]`
* $L_0(\lambda)$ is the initial radiance at wavelength $\lambda$ before it enters the medium, e.g., the sunlight reflected from the Earth's surface. The units are `[W·m⁻²·sr⁻¹·nm⁻¹]`
* $T(\lambda)$ is the transmittance of the medium, a dimensionless value between 0 and 1 representing the fraction of light that is transmitted.


---
## Transmittance

> We need to expand upon this term: transmittance as it's not just a simple value.
> Imagine the colored water again.
> The first inch of the water might block 10\% of the light.
> The next cm doesn't block another 10\% of the original amount; it blocks 10\% of the **remaining** light.
> This is an **exponential** effect.
> Each successive layer of the medium chips away a fraction of the light that made it that far.
> This is why transmittance is described by an exponential function.


Transmittance is the solution to the simplified RTE equation [](#rte-transmission).
It is defined by an exponential relationship with the **optical depth**, $\tau$.

```{math}
:label: transmittance
T(\lambda) = \exp\left[-\tau(\lambda)\right]
```

This equation shows that the transmittance is determined solely by the optical depth of the medium.
A medium with zero optical depth is perfectly transparent, i.e. $T=1$.
However, a medium with infinite optical depth is perfectly opaque, $T=0$.


---
### Optical Depth


The key to connecting this equation to gas concentrations is the optical depth, $\tau$.
It represents the cumulative effect of the entire atmospheric column on the radiance.
It is defined as the integral of the extinction coefficient, $\kappa$, along the entire path, $\mathbf{s}$.

```{math}
:label: optical-depth
\tau(\lambda) = \int_0^L \kappa(\lambda,\mathbf{s}) \cdot d\mathbf{s}
```

Furthermore, the extinction coefficient $\kappa$ can be directly related to the physical properties of the absorbing gas.
It is the product of the gas's **absorption cross-section**, $\sigma$, and it's **number density** (concentration), $n$.

```{math}
:label: extinction-coeff-gas
\kappa(\lambda,\mathbf{s}) = \sigma(\lambda,\mathbf{s}) \cdot n(\mathbf{s})
```

By subsituting this back into the optical depth equation, we see that $\tau$ is directly proportional to the total number of absorbing molecules along the path.
Therefore, by measuring the final radiance, $L$, and estimating the intial radiance, $L_0$, we can calculate the optical depth, $\tau$.
This allows us to solve for the total amount of methane (or any gas) in the atmospheric column.



---
### Multiple Gasses

In many cases, we have more than just methane in the atmosphere.
The total extinction coefficient is the sum of the extinction coefficients from all absorbing species present.

```{math}
:label: extinction-coeff-total
\kappa(\lambda,\mathbf{s}) = \sum_{i} \kappa_i(\lambda,\mathbf{s})  =\sum_{i} \sigma_i(\lambda,\mathbf{s}) \cdot n_i(\mathbf{s})
```

So for example, if we have methane (CH$_4$) and water vapor (H$_2$O), the total extinction coefficient would be

```{math}
:label: extinction-coeff-multi
\kappa(\lambda,\mathbf{s}) = \kappa_{CH_4}(\lambda,\mathbf{s}) + \kappa_{H_2O}(\lambda,\mathbf{s}) 
``` 

However, in many cases we are only interested in a single gas, e.g., methane and we can treat the other gases as part of the background extinction.
In addition, we often choose bands where the target gas has strong absorption features while other gases have minimal impact.
This allows us to isolate the contribution of methane to the total extinction coefficient, simplifying our analysis and retrieval algorithms.