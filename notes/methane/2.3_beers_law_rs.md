---
title: Beer-Lambert's Law Revisited
subject: Methane
short_title: RS Beer's Law
authors:
  - name: J. Emmanuel Johnson
    affiliations:
      - UN
    orcid: 0000-0002-6739-0053
    email: juan.johnson@un.org
license: CC-BY-4.0
keywords: methane
abbreviations:
  PSF: Point Spread Function
  SRF: Spectral Response Function
  GSD: Ground Sample Distance
  AMF: Air Mass Factor
  ODE: Ordinary Differential Equation
  RTE: Radiative Transfer Equation
---

# Deriving the Simplified Beer's Law for Gas Retrieval

In many atmospheric science papers, the Beer-Lambert Law appears in a simplified form that directly relates measured radiance to the total amount of a gas in an atmospheric column. This form is powerful but can seem disconnected from the underlying physics. This document derives that simplified equation by starting with the full, physical definition of transmittance and applying a series of well-justified assumptions common in remote sensing.

## Background Term

In our discussion of relative radiance, we conveniently bundled several complex physical interactions into a single "background radiance" term, $L_{bg}(\lambda)$. This allowed us to cancel it out and focus on the gas enhancement signal.

Now, let's unpack this term. Understanding its components is crucial for appreciating what sources of error and uncertainty are eliminated when we use the normalization technique. We will build the expression for $L_{bg}(\lambda)$ step-by-step, following the path of sunlight from space, down to the Earth's surface, and back up to the satellite sensor.

---
### The Starting Point: Extraterrestrial Solar Irradiance ($E_0$)

Everything begins with the sun. The amount of energy arriving at the top of Earth's atmosphere from the sun is called the extraterrestrial solar irradiance, $E_0(\lambda)$.

What it is: The sun's power per unit area at a specific wavelength, before it has interacted with the atmosphere.

Units: Watts per square meter per nanometer [W·m⁻²·nm⁻¹].

Key Idea: This is our initial source of light. It's a well-known quantity, but it does vary slightly with the Earth-Sun distance and solar cycles.

---
### The Downward Path: Irradiance at the Surface ($E_{surf}$)

As sunlight travels down through the atmosphere, two things happen: its path is slanted, and some of it is absorbed or scattered.

$$E_{surf}(\lambda) = E_0(\lambda) \cdot \cos(\theta_{SZA}) \cdot T_{down}(\lambda)$$

$\cos(\theta_{SZA})$: The Solar Zenith Angle (SZA) is the angle between the sun and the vertical. The cosine term accounts for the fact that sunlight is spread over a larger area when the sun is lower in the sky (at a larger angle). This reduces the intensity of the light hitting the surface directly.

$T_{down}(\lambda)$: The downwelling transmittance. This is the fraction of light (from 0 to 1) that successfully makes it to the surface without being absorbed or scattered away by the atmosphere's "background" components (like nitrogen, oxygen, and the background concentration of our target gas).

---
### Surface Reflection: Radiance from the Surface ($L_{surf}$)

Once the sunlight hits the surface, it is reflected. We need to describe how much is reflected and in what direction. For most natural surfaces, we can use the Lambertian assumption.

$$L_{surf}(\lambda) = \frac{\rho(\lambda)}{\pi} \cdot E_{surf}(\lambda)$$

$\rho(\lambda)$: The surface reflectance (or albedo). This is a dimensionless fraction (from 0 to 1) describing how reflective the surface is at a given wavelength. A snowy surface has a high $\rho$, while a dark ocean has a low $\rho$. This is often a major source of uncertainty.

$1/\pi$: This factor converts the incoming irradiance (energy from all downward directions) into outgoing radiance (energy scattered equally in all upward directions). It is a fundamental property of a perfect, diffuse (Lambertian) reflector.

---
### The Upward Path: Radiance at the Sensor ($L_{bg}$)

The light reflected from the surface now travels back up to the satellite sensor, and once again, some of it is lost to absorption and scattering.

$$L_{bg}(\lambda) = L_{surf}(\lambda) \cdot T_{up}(\lambda)$$

$T_{up}(\lambda)$: The upwelling transmittance. This is the fraction of light that successfully makes the journey from the surface to the satellite.


---
### Putting It All Together: The Full Equation

By substituting the equations from each step into the next, we arrive at the full, explicit formula for the background radiance:

$$L_{bg}(\lambda) = \left( \frac{\rho(\lambda)}{\pi} \cdot [E_0(\lambda) \cdot \cos(\theta_{SZA}) \cdot T_{down}(\lambda)] \right) \cdot T_{up}(\lambda)$$

Rearranging for clarity, we get:

$$L_{bg}(\lambda) = \frac{E_0(\lambda) \cdot \cos(\theta_{SZA})}{\pi} \cdot \rho(\lambda) \cdot T_{down}(\lambda) \cdot T_{up}(\lambda)$$

This final equation represents the complex signal we are trying to characterize when we select a "background" or "reference" pixel. It contains dependencies on the sun's angle, the surface properties, and the atmospheric state—all of which are difficult to know perfectly. By dividing our target pixel by a reference pixel, we are effectively canceling out this entire term, isolating the signal from the gas enhancement alone.

---
### Connecting to Real-World Satellite Products

While the full equation for $L_{bg}$ is complex, many of its terms can be approximated using standard, publicly available satellite data products. This is crucial for models that need to simulate a background radiance spectrum.

Solar Irradiance ($E_0$) and Geometry ($\theta_{SZA}$): These are not "products" but are fundamental inputs. The solar irradiance spectrum is taken from highly accurate reference models, and the viewing geometry (like SZA and the satellite viewing angle) is provided in the metadata of every satellite file.

Surface Reflectance ($\rho(\lambda)$): This is commonly available as a Surface Albedo or Surface Reflectance product. Missions like NASA's MODIS (Moderate Resolution Imaging Spectroradiometer) provide global, daily surface reflectance products (e.g., MOD09). These products have already been corrected for atmospheric effects, giving us a good estimate of $\rho(\lambda)$ for our equation.

Transmittance ($T_{down}$, $T_{up}$): Transmittance is rarely a direct product. Instead, we use other satellite products that quantify the atmospheric components responsible for absorption and scattering. These include:

Aerosol Optical Depth (AOD): Products from MODIS or VIIRS measure the amount of aerosols (dust, smoke, pollution) in the atmosphere, which is the largest source of scattering.

Total Column Water Vapor (TCWV): Satellites provide maps of water vapor, a significant absorber in the infrared.

Ozone Column: Products from instruments like TROPOMI or OMI give us the total amount of ozone, another key absorber.

By feeding these products (AOD, water vapor, ozone) into a radiative transfer model, scientists can accurately calculate the expected atmospheric transmittance ($T_{down}$ and $T_{up}$) for a given time and location, allowing them to construct a highly realistic model of the background radiance.

---

## The Full Physical Model of Transmittance

Let's begin with the complete, physical description of transmittance. The total transmittance, $T(\lambda)$, of the atmosphere along the full sun-to-surface-to-satellite path is given by:

This equation states that the fraction of light that survives the journey through the atmosphere depends exponentially on the **total optical depth**, $\tau_{total}(\lambda)$. The optical depth is the measure of how much stuff is in the atmosphere to block the light. It's the sum of the optical depth on the downwelling path ($\tau_{down}$) and the upwelling path ($\tau_{up}$).

Each of these is defined by a complex integral:

$$
\tau_{path}(\lambda) = \int_{\text{path}} \sigma(\lambda, s) \cdot n(s) \cdot ds
$$

* $\sigma(\lambda, s)$ is the **absorption cross-section**. Think of this as the "blocking power" or effective area of a single molecule for a given wavelength $\lambda$ at a specific point in the path, $s$. It changes with altitude because pressure and temperature affect a molecule's ability to absorb light.
* $n(s)$ is the **number density** of the gas molecules (molecules per m³), which also changes with altitude.

Putting it all together gives us the starting point—the full, physically accurate but complex equation for the transmittance of a specific gas:

$$
T_{gas}(\lambda) = \exp\left(- \left[ \int_{\text{down path}} \sigma(\lambda, s) n(s) ds + \int_{\text{up path}} \sigma(\lambda, s) n(s) ds \right] \right)
$$

This integral is difficult to work with directly. Our goal is to simplify it.

## Deconstructing the Integral: Three Key Simplifications

To make this equation useful, we introduce a series of assumptions to eliminate the integral.


### Assumption 1: From Complex Slant Paths to a Simple Vertical Column

The Problem: The integrals are over the actual, slanted paths of sunlight, which are geometrically complex. It's more intuitive and useful to talk about the amount of gas in a simple vertical column above a given spot on the ground.

The Physical Intuition: Light traveling at an angle passes through more air than light coming from directly overhead. We can use geometry to relate the length of this slant path to the simple vertical depth of the atmosphere.

The Simplification (Air Mass Factor): We bundle this geometric complexity into a single term called the Air Mass Factor (AMF or M). The AMF is a dimensionless number that tells us how many "vertical atmospheres" the light has effectively traveled through. For example, an AMF of 2 means the light traveled through a path containing twice the number of molecules as a straight vertical path. This allows us to replace the two slant path integrals with a single vertical integral:

$$
\int_{\text{down}} (...) ds + \int_{\text{up}} (...) ds \approx M \cdot \int_{\text{vertical}} (...) dz
$$

Our transmittance equation now looks much simpler:

$$
T\_{gas}(\lambda) \approx \exp\left(-M \int_0^{\infty} \sigma(\lambda, z) n(z) dz \right)
$$

---
### Assumption 2: From Altitude-Varying Properties to a Single Column Average

  * **The Problem:** We still have an integral because both the number density ($n$) and the absorption cross-section ($\sigma$) change with vertical altitude ($z$).
  * **The Physical Intuition:** While a molecule's "blocking power" ($\sigma$) technically changes with the local temperature and pressure, for many applications, we care more about the *average* blocking power of all molecules in the column. We are not trying to resolve the exact concentration at 5km versus 6km; we want the total amount in the whole column.
  * **The Simplification (Column-Averaged Cross-Section):** We assume we can define an effective, **column-averaged absorption cross-section**, $\bar{\sigma}(\lambda)$, that represents the typical absorption strength for the entire atmospheric column. Because this average value is now a constant with respect to altitude, we can pull it out of the integral:


$$
\int_0^{\infty} \sigma(\lambda, z) n(z) dz \approx \bar{\sigma}(\lambda) \int_0^{\infty} n(z) dz
$$


The Result: The integral term ∫ n(z) dz has a clear physical meaning: it is the sum of all molecules in every layer of the vertical column. This is the definition of the Total Vertical Column Density, $N_v$, with units of molecules per area (e.g., molecules/m²).

With this, the integral is completely eliminated. The optical depth is now simply the product of three terms:

$$
\tau_{gas}(\lambda) \approx M \cdot \bar{\sigma}(\lambda) \cdot N_v
$$

---
## Assumption 3: Separating Background Gas and Local Enhancements

* **The Problem:** The Total Column Density ($N_v$) represents *all* the gas molecules, but often the atmosphere has a large, stable background amount of a gas (e.g., methane's global background). For many applications, like finding methane leaks, we only care about the small, *additional* amount of gas on top of this background—the enhancement.
* **The Physical Intuition:** If you are measuring the height of a person wearing a hat, it's easier to measure the person's height (background) and the hat's height (enhancement) separately than to always refer to the total combined height.
* **The Simplification:** We can separate the total column into two additive parts: a well-understood background column and an unknown enhancement column (the plume).

$$
N_v = N_{v, \text{bg}} + N\_{v, \Delta}
$$


This means the transmittance term can also be split, because $\exp(a+b) = \exp(a) \cdot \exp(b)$

$$
T_{gas}(\lambda) = \exp(-M \bar{\sigma} (N_{v, \text{bg}} + N_{v, \Delta})) = T_{\text{bg}}(\lambda) \cdot T_{\Delta}(\lambda)
$$

## The Final Simplified Model for Retrieval

By applying these three assumptions, we have transformed the complex physical equation into a simple, powerful tool. We can now substitute our simplified transmittance term back into the full radiance equation:

$$
L_{TOA}(\lambda) = \underbrace{\frac{E_0(\lambda)\cos(\theta_{SZA})}{\pi} \cdot \rho(\lambda) \cdot T_{\text{other}}(\lambda) \cdot T_{\text{bg}}(\lambda)}_{\text{Effective Background Radiance, } L_{bg}(\lambda)} \cdot T_{\Delta}(\lambda)
$$

This leads to the final simplified Beer's Law used in retrievals:

$$
L_{TOA}(\lambda) = L_{bg}(\lambda) \cdot \exp(-M \cdot \bar{\sigma}(\lambda) \cdot N_{v, \Delta})
$$


Here, the measured radiance at the top of the atmosphere is directly related to the enhancement column ($N_{v, \Delta}$), the quantity we want to find. All other complex physics have been bundled into the geometry factor ($M$), an effective background radiance ($L_{bg}$), and the gas's known absorption spectrum ($\bar{\sigma}$).

## From Column Density to Mixing Ratio

The final step is to convert the physical unit of vertical column density ($N_v$) into the more commonly used column-averaged dry-air mixing ratio ($X_{gas}$), often expressed in parts per million (ppm) or billion (ppb). This is the value typically reported in satellite data products and used in models.

The Physical Connection: The mixing ratio at any altitude, $c(z)$, is the ratio of the number density of our target gas to the number density of dry air: $c(z) = n_{gas}(z) / n_{air}(z)$. We can therefore express the vertical column density as an integral involving the mixing ratio:

$$
N_v = \int_0^{\infty} n_{gas}(z) dz = \int_0^{\infty} c(z) \cdot n_{air}(z) dz
$$


The Simplification (Column-Averaged Mixing Ratio): We assume that a single, pressure-weighted average mixing ratio, $X_{gas}$, can represent the entire column. This allows us to pull it out of the integral:

$$
N_v \approx X\_{gas} \cdot \int_0^{\infty} n_{air}(z) dz = X_{gas} \cdot N_{v, air}
$$

Here, $N_{v, air}$ is the total vertical column of air, a value typically derived from surface pressure data from meteorological models.

The Final Model for Retrieval: By substituting this into our expression for optical depth and separating the background ($X_{bg}$) and enhancement ($X_{\Delta}$) components, we arrive at the final simplified Beer's Law:

$$
L_{TOA}(\lambda) \approx L_{bg}(\lambda) \cdot \exp(-M \cdot \bar{\sigma}(\lambda) \cdot X_{\Delta} \cdot N_{v, air})
$$

In this equation, the goal of the retrieval algorithm is to solve for $X_{\Delta}$, the enhancement in the column-averaged mixing ratio. All other terms are either measured, modeled from look-up tables (LUTs), or known physical constants.

---
## Literature Differences

In remote sensing literature and retrieval algorithms, the simplified Beer-Lambert Law is often expressed in slightly different, though equivalent, ways. A common point of confusion is the relationship between a model that uses the enhancement vertical column density ($N_{v, \Delta}$) and a model that uses the column-averaged mixing ratio enhancement ($X_{\Delta}$). This document clarifies how these two forms relate to each other.

### Two Forms of the Same Equation

Let's look at the exponent in the transmittance term, which represents the optical depth of the gas enhancement ($\tau_{\Delta}$). You will commonly encounter two forms:

Form 1: Based on Vertical Column Density
This is the most direct physical representation. Here, the optical depth is a function of the total number of extra gas molecules in the column.

$$\tau_{\Delta}(\lambda) = M \cdot \bar{\sigma}(\lambda) \cdot N_{v, \Delta}$$

$N_{v, \Delta}$: The enhancement in the vertical column density (the quantity often called L in simplified notations), with units of molecules/m².

Form 2: Based on Mixing Ratio
This form is often more practical for retrieval algorithms, as it uses quantities that align with atmospheric models and ancillary data.

$$\tau_{\Delta}(\lambda) = M \cdot \bar{\sigma}(\lambda) \cdot X_{\Delta} \cdot N_{v, \text{air}}$$

$X_{\Delta}$: The enhancement in the column-averaged dry-air mixing ratio, which is dimensionless (or expressed in ppm/ppb).

$N_{v, \text{air}}$: The total vertical column density of air, with units of molecules/m².

### The Connection

The two forms are mathematically equivalent. The bridge between them is the definition of the column-averaged mixing ratio itself: the total number of gas molecules in a column is simply the mixing ratio multiplied by the total number of air molecules in that same column.

Therefore, we have the direct relationship:

$$N_{v, \Delta} \approx X_{\Delta} \cdot N_{v, \text{air}}$$

By substituting this relationship into Form 1, you directly obtain Form 2.

### Why Use the Mixing Ratio Form?

While Form 1 is more direct, Form 2 is often used in practice because it separates the problem into two distinct parts:

$X_{\Delta}$: The quantity the retrieval algorithm is designed to solve for. This is the final data product (e.g., the methane enhancement in ppb).

$N_{v, \text{air}}$: A quantity that can be estimated independently using ancillary data, typically from a weather model's surface pressure readings.

This separation makes the retrieval process more modular and practical.


---
## Relative Radiance Formulation

In atmospheric remote sensing, the ultimate goal is often to isolate the absorption signature of a specific gas from all other signals. However, the radiance measured by a satellite is a complex product of solar light, surface reflection, and absorption/scattering by various atmospheric components. A powerful technique to simplify this problem is to work with relative (or normalized) radiance, which cancels out many of these complex background effects.

### The Starting Point: The Simplified Radiance Model

From our previous derivations, we arrived at a simplified model for the top-of-atmosphere (TOA) radiance, which separates the background effects from the signal of a gas enhancement:

$$L_{TOA}(\lambda) = L_{bg}(\lambda) \cdot T_{\Delta}(\lambda)$$

Where:

$L_{TOA}(\lambda)$ is the total radiance measured by the satellite.

$L_{bg}(\lambda)$ is the "background radiance." This term bundles together the extraterrestrial solar irradiance, surface reflectance, atmospheric scattering, and the absorption from the background concentration of the gas.

$T_{\Delta}(\lambda) = \exp(-M \cdot \bar{\sigma}(\lambda) \cdot N_{v, \Delta})$ is the transmittance term associated only with the gas enhancement plume we want to measure.

### Normalization: Isolating the Enhancement Signal

The core idea behind relative radiance is to divide the measured radiance by the background radiance. This is often done by selecting a nearby pixel that is assumed to be free of the enhancement plume to serve as the background reference.

By rearranging the equation above, we can define the relative radiance, $L_{rel}(\lambda)$:

$$L_{rel}(\lambda) = \frac{L_{TOA}(\lambda)}{L_{bg}(\lambda)}$$

When we perform this division, the background term cancels out, leaving us with a remarkably simple expression:

$$L_{rel}(\lambda) = T_{\Delta}(\lambda) = \exp(-M \cdot \bar{\sigma}(\lambda) \cdot N_{v, \Delta})$$

### The Advantage of Using Relative Radiance

This normalization step is a cornerstone of many retrieval algorithms because it effectively removes the largest sources of uncertainty and complexity from the problem.

Eliminates Surface and Solar Dependence: By dividing by $L_{bg}$, we no longer need to have perfect knowledge of the surface reflectance ($\rho$) or the incoming solar irradiance ($E_0$), as these factors are present in both the numerator and the denominator and thus cancel out.

Isolates the Target Signal: The resulting quantity, the relative radiance, is now purely a function of the gas enhancement's optical depth. All the physics of the gas absorption are contained in this clean, exponential signal.

Simplifies the Retrieval: Instead of fitting a complex physical model, the retrieval algorithm's job is simplified to fitting an exponential decay curve. The "depth" of the absorption features in the relative radiance spectrum is directly proportional to the amount of the gas enhancement ($N_{v, \Delta}$), making it much easier to solve for.

### Practical Implementation: Reference Pixels and Delta Concentrations

In a real-world application, the theoretical "background radiance" ($L_{bg}$) is not perfectly known. Instead, we approximate it by using the radiance measured from a nearby reference pixel ($L_{ref}$), which is assumed to be upwind or otherwise unaffected by the emission plume we are targeting.

The radiance for this reference pixel contains the background concentration of the gas, let's call it $C_{ref}$. The radiance for our target pixel contains the total concentration, $C_{target}$, which is a sum of the background and the enhancement ($C_{target} = C_{ref} + \Delta C$).

When we normalize our target pixel's radiance by the reference pixel's radiance, we are practically performing this operation:

$$\frac{L_{target}(\lambda)}{L_{ref}(\lambda)} = \frac{L_{base}(\lambda) \cdot T(C_{ref} + \Delta C)}{L_{base}(\lambda) \cdot T(C_{ref})} = \frac{T(C_{ref}) \cdot T(\Delta C)}{T(C_{ref})} = T(\Delta C)$$

This shows that the normalization process intrinsically isolates the transmittance of the enhancement concentration ($\Delta C$).

As a result, the quantity we solve for in the equation—whether it's the vertical column density ($N_{v, \Delta}$) or the mixing ratio ($X_{\Delta}$)—is not the absolute concentration. It is fundamentally a differential or delta value: the excess concentration in the target pixel relative to the concentration in the chosen reference pixel.



---
## Extra Notes

### Constructing the Top-of-the Atmosphere Radiance

**Extraterrestrial Solar Irradiance**

$$
E(\lambda,0)
$$

**Downwelling Path**

$$
E_{surf}(\lambda,s) = E(\lambda,0)\cdot \cos(\theta_{SZA})\cdot T_{d}(\lambda,s)
$$

Let $\rho(\lambda)$ be the surface reflectance (dimensionless) and $\rho\in\mathbb{R}^{[0,1]}$.

**Surface Reflection**

$$
L_{surf}(\lambda,s) = \frac{\rho(\lambda)}{\pi}E_{surf}(\lambda,s)
$$

**Full Radiance Equation**

$$
L_{TOA}(\lambda,s) = \frac{E(\lambda,0)\cdot \cos(\theta_{SZA})}{\pi}
\cdot\rho(\lambda)
\cdot T_{down}(\lambda,s)
\cdot T_{up}(\lambda,s)
$$

If we separate the terms


---
### Gas Enhancement

We can acknowledge that there is a background concentration that is always present.
However, we are interested in the *excess* concentration on top of the background concentration, i.e., the *enhancement* concentration.

$$
\kappa_{gas}(\lambda,s) = \kappa_{bg}(\lambda,s) + \kappa_\Delta(\lambda,s)
$$


**Extinction Coefficient**

$$
\kappa_{gas}(\lambda,s) = \sigma(\lambda,s)\cdot n(s)
$$

* $\sigma(\lambda,s)$ - absorption cross-section
* $n(s)$ - # density of gas molecules

This says that the total optical depth is the sum of the absorption: # of molecules $\times$ absorption power per molecule over every increment of the path.


$$
\kappa_{gas}(\lambda,s) = \nu(\lambda,s)\cdot \rho(s)
$$

* $\nu(\lambda,s)$ - mass extinction cross-section
* $\rho(s)$ - mass density

**Total Density of Gas Molecules**

$$
n(s) = q(s) \cdot \frac{\rho_{air}(s)}{m_{gas}}
$$

where
* $\rho_{air}(s)$ - air density
* $m_{gas}$ - molecular mass of gas


$$
c(s) = \frac{\rho_{gas}(s)}{\rho_{air}(s)}
$$

#### Mixing Ratio

$$
c(s) = \frac{n_{gas}(s)}{n_{air}(s)}
$$

This is a dimensionless quantity.
We can make it in ppm by multiplying by $10^{-6}$.

### Assumptions

* Constant Absorption Cross-Spectrum (Column Averaged?)
* Constant # Density for Air
* Mixing Ratio Length